'use client';

import { useState, useEffect } from 'react';
import { AnimatePresence, motion } from 'framer-motion';
import Hero from './Hero';
import About from './About';
import Skills from './Skills';
import Experience from './Experience';
import Projects from './Projects';
import Education from './Education';
import Contact from './Contact';

const sections = [
  { label: 'In√≠cio', component: <Hero key="hero" /> },
  { label: 'Sobre', component: <About key="about" /> },
  { label: 'Skills', component: <Skills key="skills" /> },
  { label: 'Experi√™ncia', component: <Experience key="experience" /> },
  { label: 'Projetos', component: <Projects key="projects" /> },
  { label: 'Educa√ß√£o', component: <Education key="education" /> },
  { label: 'Contacto', component: <Contact key="contact" /> },
];

const SlideNavigator = () => {
  const [index, setIndex] = useState(0);

  const next = () => setIndex((current) => (current + 1) % sections.length);
  const prev = () => setIndex((current) => (current - 1 + sections.length) % sections.length);

  useEffect(() => {
    const handleKeyDown = (e: KeyboardEvent) => {
      if (e.key === 'ArrowRight') next();
      if (e.key === 'ArrowLeft') prev();
    };
    window.addEventListener('keydown', handleKeyDown);
    return () => window.removeEventListener('keydown', handleKeyDown);
  }, []);

  return (
    <div className="min-h-screen w-full overflow-hidden relative bg-white pt-0 md:pt-16">
      {/* üîù Navbar horizontal no topo (escondido em mobile) */}
      <div className="hidden md:flex absolute top-0 left-0 right-0 justify-center gap-6 py-4 bg-white z-10">
        {sections.map((section, i) => (
          <button
            key={i}
            onClick={() => setIndex(i)}
            className={`text-sm font-medium transition ${
              i === index ? 'text-gray-900 underline' : 'text-gray-500 hover:text-gray-800'
            }`}
          >
            {section.label}
          </button>
        ))}
      </div>

      {/* üé¨ Slide atual com anima√ß√£o e swipe */}
      <AnimatePresence mode="wait">
        <motion.div
          key={index}
          initial={{ opacity: 0, y: 50 }}
          animate={{ opacity: 1, y: 0 }}
          exit={{ opacity: 0, y: -50 }}
          transition={{ duration: 0.6 }}
          drag="x"
          dragConstraints={{ left: 0, right: 0 }}
          onDragEnd={(e, info) => {
            if (info.offset.x < -100) next();
            if (info.offset.x > 100) prev();
          }}
          className="absolute inset-0"
        >
          {sections[index].component}
        </motion.div>
      </AnimatePresence>

      {/* üîª Bot√µes de navega√ß√£o + indicadores */}
      <div className="absolute bottom-6 left-0 right-0 flex justify-between px-6">
        <button
          onClick={prev}
          disabled={index === 0}
          className={`px-4 py-2 border rounded transition ${
            index === 0 ? 'opacity-50 cursor-not-allowed' : 'hover:bg-gray-200'
          }`}
        >
          ‚Üê
        </button>
        <button
          onClick={next}
          disabled={index === sections.length - 1}
          className={`px-4 py-2 border rounded transition ${
            index === sections.length - 1 ? 'opacity-50 cursor-not-allowed' : 'hover:bg-gray-200'
          }`}
        >
          ‚Üí
        </button>
      </div>
    </div>
  );
};

export default SlideNavigator;
